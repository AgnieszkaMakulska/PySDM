TODO rename state.x -> state.v
TODO test SD_num=1, 5, etc.
TODO interfaces?